<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>tensorpac.visu &#8212; Tensorpac 0.5.6 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/ico64.png"></span>
          Tensorpac</a>
        <span class="navbar-text navbar-version pull-left"><b>0.5.6</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul>
<li class="toctree-l1"><a class="reference internal" href="../../methods.html">Implemented methods</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../methods.html#modular-philosophy">Modular philosophy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../methods.html#pac-methods">Pac methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../methods.html#surrogates-methods">Surrogates methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../methods.html#normalization-methods">Normalization methods</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../methods.html#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#cross-frequency-coupling-measures">Cross-frequency coupling measures</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#pac-object">PAC object</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#filter-the-data">Filter the data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#compute-pac-on-filtered-data">Compute PAC on filtered data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#filter-then-compute-pac">Filter then compute PAC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#preferred-phase">Preferred-phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#event-related-phase-amplitude-coupling">Event-Related Phase-Amplitude Coupling</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#visualization">Visualization</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#d-plot">2D plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#comodulogram">Comodulogram</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#triangular-plot">Triangular plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#polar-plot">Polar plot</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#show">Show</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#save">Save</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#utils">Utils</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#generate-artificially-coupled-signals-using-tort-method">Generate artificially coupled signals using Tort method</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#generate-artificially-coupled-signals-using-wavelets">Generate artificially coupled signals using wavelets</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#generate-phase-and-amplitude-vectors">Generate phase and amplitude vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#generate-triangular-vectors">Generate triangular vectors</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#pearson-correlation">Pearson correlation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#circular-correlation">Circular correlation</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../auto_examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_bandwidth_signals.html">Generate a coupling between specific bands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_readme.html">README example</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_values.html">Compute p-values</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_fmin_fmax_optmization.html">Find the optimal bandwidth</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_frequency_vectors.html">Define frequency vectors</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_compare_surrogates.html">Compare surrogate methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_pac_methods.html">Compare PAC methods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_compare_normalizations.html">Compare normalizations</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_compare_filtering.html">Compare filtering properties</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_basic_pac.html">Basic phase amplitude coupling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_artificially_coupled_signals.html">Generate artificially coupled signals</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_long_range_coupling.html">Long-range PAC</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_erpac.html">Compute the ERPAC (Voytek et al 2013)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../auto_examples/plot_preferred_phase.html">Find the preferred phase (PP)</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm"></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <h1>Source code for tensorpac.visu</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;Visualization functions.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;PacPlot&#39;</span><span class="p">)</span>


<div class="viewcode-block" id="PacPlot"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.PacPlot">[docs]</a><span class="k">class</span> <span class="nc">PacPlot</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Main PAC plotting class.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Init.&quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autovmM</span> <span class="o">=</span> <span class="kc">True</span>

<div class="viewcode-block" id="PacPlot.pacplot"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.PacPlot.pacplot">[docs]</a>    <span class="k">def</span> <span class="nf">pacplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pac</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">under</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">over</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">bad</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">pvalues</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">rmaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dpaxis</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">plotas</span><span class="o">=</span><span class="s1">&#39;imshow&#39;</span><span class="p">,</span> <span class="n">ncontours</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span>
                <span class="n">levels</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">levelcmap</span><span class="o">=</span><span class="s1">&#39;Reds&#39;</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.02</span><span class="p">,</span>
                <span class="n">subplot</span><span class="o">=</span><span class="mi">111</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Main plotting pac function.</span>

<span class="sd">        This method can be used to plot any 2D array.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pac : array_like</span>
<span class="sd">            A 2D array.</span>

<span class="sd">        xvec : array_like</span>
<span class="sd">            The vector to use for the x-axis.</span>

<span class="sd">        yvec : array_like</span>
<span class="sd">            The vector to use for the y-axis.</span>

<span class="sd">        xlabel : string | &#39;&#39;</span>
<span class="sd">            Label for the x-axis.</span>

<span class="sd">        ylabel : string | &#39;&#39;</span>
<span class="sd">            Label for the y-axis.</span>

<span class="sd">        cblabel : string | &#39;&#39;</span>
<span class="sd">            Label for the colorbar.</span>

<span class="sd">        title : string | &#39;&#39;</span>
<span class="sd">            Title of the plot.</span>

<span class="sd">        y : float | 1.02</span>
<span class="sd">            Title location.</span>

<span class="sd">        cmap : string | &#39;viridis&#39;</span>
<span class="sd">            Name of one Matplotlib&#39;s colomap.</span>

<span class="sd">        vmin : float | None</span>
<span class="sd">            Threshold under which set the color to the uner parameter.</span>

<span class="sd">        vmax : float | None</span>
<span class="sd">            Threshold over which set the color in the over parameter.</span>

<span class="sd">        under : string | &#39;gray&#39;</span>
<span class="sd">            Color for values under the vmin parameter.</span>

<span class="sd">        over : string | &#39;red&#39;</span>
<span class="sd">            Color for values over the vmax parameter.</span>

<span class="sd">        bad : string | None</span>
<span class="sd">            Color for non-significant values.</span>

<span class="sd">        pvalues : array_like | None</span>
<span class="sd">            P-values to use for masking PAC values. The shape of this</span>
<span class="sd">            parameter must be the same as the shape as pac.</span>

<span class="sd">        p : float | .05</span>
<span class="sd">            If pvalues is pass, use this threshold for masking</span>
<span class="sd">            non-significant PAC.</span>

<span class="sd">        interp : tuple | None</span>
<span class="sd">            Tuple for controlling the 2D interpolation. For example,</span>
<span class="sd">            (.1, .1) will multiply the number of row and columns by 10.</span>

<span class="sd">        rmaxis : bool | False</span>
<span class="sd">            Remove unecessary axis.</span>

<span class="sd">        dpaxis : bool | False</span>
<span class="sd">            Despine axis.</span>

<span class="sd">        plotas : {&#39;imshow&#39;, &#39;contour&#39;, &#39;pcolor&#39;}</span>
<span class="sd">            Choose how to display the comodulogram, either using imshow</span>
<span class="sd">            (&#39;imshow&#39;) or contours (&#39;contour&#39;). If you choose &#39;contour&#39;,</span>
<span class="sd">            use the ncontours parameter for controlling the number of</span>
<span class="sd">            contours.</span>

<span class="sd">        ncontours : int | 5</span>
<span class="sd">            Number of contours if plotas is &#39;contour&#39;.</span>

<span class="sd">        levels : list | None</span>
<span class="sd">            Add significency levels. This parameter must be a sorted list</span>
<span class="sd">            of p-values to use as levels.</span>

<span class="sd">        levelcmap : string | Reds</span>
<span class="sd">            Colormap of signifiency levels.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">            gca: axes</span>
<span class="sd">                The current matplotlib axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Check if pac is 2 dimensions :</span>
        <span class="k">if</span> <span class="n">pac</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The PAC variable must have two dimensions.&quot;</span><span class="p">)</span>
        <span class="c1"># Try import matplotlib :</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Matplotlib not installed.&quot;</span><span class="p">)</span>
        <span class="c1"># Define p-values (if needed) :</span>
        <span class="k">if</span> <span class="n">pvalues</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pvalues</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">pac</span><span class="p">)</span>
        <span class="c1"># 2D interpolation (if needed)</span>
        <span class="k">if</span> <span class="n">interp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pac</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span> <span class="o">=</span> <span class="n">mapinterpolation</span><span class="p">(</span><span class="n">pac</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span>
                                               <span class="n">interp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">pvalues</span> <span class="o">=</span> <span class="n">mapinterpolation</span><span class="p">(</span><span class="n">pvalues</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yvec</span><span class="p">,</span>
                                       <span class="n">interp</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interp</span><span class="p">[</span><span class="mi">1</span><span class="p">])[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">pac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">pac</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="n">pvalues</span> <span class="o">&gt;=</span> <span class="n">p</span><span class="p">)</span>
        <span class="c1"># Polar plot :</span>
        <span class="k">if</span> <span class="n">polar</span><span class="p">:</span>
            <span class="n">plotas</span> <span class="o">=</span> <span class="s1">&#39;pcolor&#39;</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">subplot</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;polar&#39;</span><span class="p">)</span>
        <span class="c1"># Check vmin / vmax</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vmin</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">vmax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">_autovmM</span><span class="p">:</span>
            <span class="n">vmin</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pac</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
            <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">pac</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">vmin</span> <span class="o">&lt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">vmax</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">vmax</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span> <span class="o">-</span><span class="n">vmin</span><span class="p">)</span>
                <span class="n">vmin</span> <span class="o">=</span> <span class="o">-</span><span class="n">vmax</span>
        <span class="c1"># Plot type :</span>
        <span class="n">toplot</span> <span class="o">=</span> <span class="n">pac</span><span class="o">.</span><span class="n">data</span> <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="k">else</span> <span class="n">pac</span>
        <span class="k">if</span> <span class="n">plotas</span> <span class="ow">is</span> <span class="s1">&#39;imshow&#39;</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">toplot</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;auto&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">origin</span><span class="o">=</span><span class="s1">&#39;upper&#39;</span><span class="p">,</span>
                            <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">interpolation</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                            <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">xvec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">plotas</span> <span class="ow">is</span> <span class="s1">&#39;contour&#39;</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">contourf</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">toplot</span><span class="p">,</span> <span class="n">ncontours</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span>
                              <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">plotas</span> <span class="ow">is</span> <span class="s1">&#39;pcolor&#39;</span><span class="p">:</span>
            <span class="n">im</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">pcolormesh</span><span class="p">(</span><span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">toplot</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">cmap</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span>
                                <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">antialiased</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The plotas parameter must either be &#39;imshow&#39; or &quot;</span>
                             <span class="s2">&quot;&#39;contour&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># Add levels :</span>
        <span class="k">if</span> <span class="n">levels</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">plt</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">pvalues</span><span class="p">,</span> <span class="n">extent</span><span class="o">=</span><span class="p">[</span><span class="n">xvec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">xvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">yvec</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">yvec</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]],</span>
                        <span class="n">levels</span><span class="o">=</span><span class="n">levels</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="n">levelcmap</span><span class="p">)</span>

        <span class="c1"># Under/Over/Bad :</span>
        <span class="k">if</span> <span class="n">under</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">set_under</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">under</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">over</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">set_over</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">over</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">bad</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">im</span><span class="o">.</span><span class="n">cmap</span><span class="o">.</span><span class="n">set_bad</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="n">bad</span><span class="p">)</span>

        <span class="c1"># Title/Xlabel/Ylabel :</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="n">title</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="n">y</span><span class="p">)</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">clim</span><span class="p">(</span><span class="n">vmin</span><span class="o">=</span><span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">)</span>

        <span class="c1"># Colorbar</span>
        <span class="n">cb</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">colorbar</span><span class="p">(</span><span class="n">im</span><span class="p">,</span> <span class="n">shrink</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">pad</span><span class="o">=</span><span class="mf">0.01</span><span class="p">,</span> <span class="n">aspect</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">set_label</span><span class="p">(</span><span class="n">cblabel</span><span class="p">)</span>
        <span class="n">cb</span><span class="o">.</span><span class="n">outline</span><span class="o">.</span><span class="n">set_visible</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>

        <span class="c1"># Remove axis :</span>
        <span class="k">if</span> <span class="n">rmaxis</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">loc</span><span class="p">,</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;top&#39;</span><span class="p">,</span> <span class="s1">&#39;right&#39;</span><span class="p">]:</span>
                    <span class="n">spine</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
                    <span class="n">ax</span><span class="o">.</span><span class="n">tick_params</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="n">loc</span><span class="p">:</span> <span class="kc">False</span><span class="p">})</span>

        <span class="c1"># Despine axis :</span>
        <span class="k">if</span> <span class="n">dpaxis</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">loc</span><span class="p">,</span> <span class="n">spine</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">spines</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
                <span class="k">if</span> <span class="n">loc</span> <span class="ow">in</span> <span class="p">[</span><span class="s1">&#39;left&#39;</span><span class="p">,</span> <span class="s1">&#39;bottom&#39;</span><span class="p">]:</span>
                    <span class="n">spine</span><span class="o">.</span><span class="n">set_position</span><span class="p">((</span><span class="s1">&#39;outward&#39;</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
                    <span class="n">spine</span><span class="o">.</span><span class="n">set_smart_bounds</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span></div>

<div class="viewcode-block" id="PacPlot.comodulogram"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.PacPlot.comodulogram">[docs]</a>    <span class="k">def</span> <span class="nf">comodulogram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pac</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Frequency for phase (hz)&#39;</span><span class="p">,</span>
                     <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Frequency for amplitude (hz)&#39;</span><span class="p">,</span>
                     <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;PAC values&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Plot PAC using comodulogram.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pac : array_like</span>
<span class="sd">            PAC array of shape (namp, pha)</span>

<span class="sd">        xlabel : string | &#39;Frequency for phase (hz)&#39;</span>
<span class="sd">            Label for the phase axis.</span>

<span class="sd">        ylabel : string | &#39;Frequency for amplitude (hz)&#39;</span>
<span class="sd">            Label for the amplitude axis.</span>

<span class="sd">        cblabel : string | &#39;PAC values&#39;</span>
<span class="sd">            Colorbar.</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Further arguments are passed to the pacplot() method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gca : axes</span>
<span class="sd">            The current matplotlib axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">xvec</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">yvec</span>
        <span class="c1"># Disable automatic vmin/vmax :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autovmM</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pacplot</span><span class="p">(</span><span class="n">pac</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">cblabel</span><span class="p">,</span>
                            <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PacPlot.triplot"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.PacPlot.triplot">[docs]</a>    <span class="k">def</span> <span class="nf">triplot</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">pac</span><span class="p">,</span> <span class="n">fvec</span><span class="p">,</span> <span class="n">tridx</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Starting frequency (hz)&#39;</span><span class="p">,</span>
                <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Ending frequency (hz)&#39;</span><span class="p">,</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;PAC values&#39;</span><span class="p">,</span>
                <span class="n">bad</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Triangular plot.</span>

<span class="sd">        The triplot method is used to find the [starting, ending] frequency</span>
<span class="sd">        either for the phase or for the amplitude.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        pac : array_like</span>
<span class="sd">            Pac array of shape (namp, npha)</span>

<span class="sd">        fvec : array_like</span>
<span class="sd">            The frequency vector returned by the pac_trivec function.</span>

<span class="sd">        tridx : array_like</span>
<span class="sd">            The index vector used to build the triangle. This argument is</span>
<span class="sd">            also returned by the pac_trivec function.</span>

<span class="sd">        xlabel : string | &#39;Starting frequency (hz)&#39;</span>
<span class="sd">            Label for the phase axis.</span>

<span class="sd">        ylabel : string | &#39;Ending frequency (hz)&#39;</span>
<span class="sd">            Label for the amplitude axis.</span>

<span class="sd">        cblabel : string | &#39;PAC values&#39;</span>
<span class="sd">            Colorbar.</span>

<span class="sd">        bad : string | &#39;lightgray&#39;</span>
<span class="sd">            Color for non-significant values.</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Further arguments are passed to the pacplot() method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gca : axes</span>
<span class="sd">            The current matplotlib axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">pac</span><span class="p">,</span> <span class="n">tridx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">pac</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">tridx</span><span class="p">)</span>
        <span class="c1"># ___________________ CHECKING ___________________</span>
        <span class="c1"># Check if pac is a raw vector :</span>
        <span class="k">if</span> <span class="n">pac</span><span class="o">.</span><span class="n">ndim</span> <span class="ow">is</span> <span class="ow">not</span> <span class="mi">1</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;The PAC variable must be a row vector.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">pac</span><span class="p">)</span> <span class="o">!=</span> <span class="n">tridx</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;PAC and tridx variables must have the same &quot;</span>
                             <span class="s2">&quot;length.&quot;</span><span class="p">)</span>

        <span class="c1"># ___________________ RECONSTRUCT ___________________</span>
        <span class="n">npac</span> <span class="o">=</span> <span class="n">tridx</span><span class="o">.</span><span class="n">max</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span>
        <span class="n">rpac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">npac</span><span class="p">,</span> <span class="n">npac</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">float</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">num</span><span class="p">,</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">tridx</span><span class="p">):</span>
            <span class="n">rpac</span><span class="p">[</span><span class="n">k</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">k</span><span class="p">[</span><span class="mi">1</span><span class="p">]]</span> <span class="o">=</span> <span class="n">pac</span><span class="p">[</span><span class="n">num</span><span class="p">]</span>
        <span class="c1"># Build mask :</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">rpac</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">bool</span><span class="p">)</span>
        <span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># Mask the lower triangle :</span>
        <span class="n">rpac</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ma</span><span class="o">.</span><span class="n">masked_array</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">flipud</span><span class="p">(</span><span class="n">rpac</span><span class="p">),</span> <span class="n">mask</span><span class="o">=</span><span class="n">mask</span><span class="p">)</span>

        <span class="c1"># ___________________ PLOT ___________________</span>
        <span class="c1"># Define frequency vector :</span>
        <span class="n">vector</span> <span class="o">=</span> <span class="n">fvec</span><span class="p">[</span><span class="n">tridx</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="n">xvec</span> <span class="o">=</span> <span class="n">yvec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vector</span><span class="p">,</span> <span class="p">[</span><span class="n">fvec</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
        <span class="c1"># Enable automatic vmin/vmax :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autovmM</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pacplot</span><span class="p">(</span><span class="n">rpac</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">xlabel</span><span class="p">,</span> <span class="n">ylabel</span><span class="p">,</span> <span class="n">cblabel</span><span class="p">,</span>
                            <span class="n">bad</span><span class="o">=</span><span class="n">bad</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PacPlot.polar"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.PacPlot.polar">[docs]</a>    <span class="k">def</span> <span class="nf">polar</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">amp</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">interp</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Polar representation.</span>

<span class="sd">        This method is used to visualize amplitude as a function of phase using</span>
<span class="sd">        a polar (circle) representation.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        amp : array_like</span>
<span class="sd">            2D array.</span>

<span class="sd">        xvec : array_like</span>
<span class="sd">            Vector for the x-axis.</span>

<span class="sd">        yvec : array_like</span>
<span class="sd">            Vector for the y-axis (phases).</span>

<span class="sd">        interp : float | None</span>
<span class="sd">            Interplation factor.</span>

<span class="sd">        kwargs : dict</span>
<span class="sd">            Further arguments are passed to the pacplot() method.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        gca : axes</span>
<span class="sd">            The current matplotlib axes.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Interpolation :</span>
        <span class="k">if</span> <span class="n">interp</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">amp</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">xvec</span> <span class="o">=</span> <span class="n">mapinterpolation</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">interp</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="c1"># Disable automatic vmin/vmax :</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_autovmM</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">pacplot</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">xvec</span><span class="p">,</span> <span class="n">yvec</span><span class="p">,</span> <span class="n">polar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="PacPlot.show"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.PacPlot.show">[docs]</a>    <span class="k">def</span> <span class="nf">show</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Display the figure.&quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>

<div class="viewcode-block" id="PacPlot.savefig"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.PacPlot.savefig">[docs]</a>    <span class="k">def</span> <span class="nf">savefig</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="mi">600</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Save the figure.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        filename : string</span>
<span class="sd">            The name of the figure to save.</span>

<span class="sd">        dpi : int | 600</span>
<span class="sd">            DPI of the figure.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">savefig</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dpi</span><span class="o">=</span><span class="n">dpi</span><span class="p">,</span> <span class="n">bbox_inches</span><span class="o">=</span><span class="s1">&#39;tight&#39;</span><span class="p">)</span></div></div>


<div class="viewcode-block" id="mapinterpolation"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.mapinterpolation">[docs]</a><span class="k">def</span> <span class="nf">mapinterpolation</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">interpx</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">interpy</span><span class="o">=</span><span class="mi">1</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Interpolate a 2D map.&quot;&quot;&quot;</span>
    <span class="c1"># Get data size :</span>
    <span class="n">dim2</span><span class="p">,</span> <span class="n">dim1</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span>
    <span class="c1"># Define xticklabel and yticklabel :</span>
    <span class="k">if</span> <span class="n">x</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim1</span><span class="p">,</span> <span class="n">interpx</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim2</span><span class="p">,</span> <span class="n">interpy</span><span class="p">)</span>
    <span class="c1"># Define the meshgrid :</span>
    <span class="n">Xi</span><span class="p">,</span> <span class="n">Yi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim1</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interpx</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">dim2</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">interpy</span><span class="p">))</span>
    <span class="c1"># 2D interpolation :</span>
    <span class="n">datainterp</span> <span class="o">=</span> <span class="n">interp2</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">Xi</span><span class="p">,</span> <span class="n">Yi</span><span class="p">)</span>
    <span class="c1"># Linearly interpolate vectors :</span>
    <span class="n">xveci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">x</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">datainterp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
    <span class="n">yveci</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">y</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">y</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">datainterp</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">datainterp</span><span class="p">,</span> <span class="n">xveci</span><span class="p">,</span> <span class="n">yveci</span></div>


<div class="viewcode-block" id="interp2"><a class="viewcode-back" href="../../tensorpac.html#tensorpac.pac.interp2">[docs]</a><span class="k">def</span> <span class="nf">interp2</span><span class="p">(</span><span class="n">z</span><span class="p">,</span> <span class="n">xi</span><span class="p">,</span> <span class="n">yi</span><span class="p">,</span> <span class="n">extrapval</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Linear interpolation.</span>

<span class="sd">    This function is equivalent to interp2(z, xi, yi,&#39;linear&#39;) in Matlab.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    z : array_like</span>
<span class="sd">        Array to interpolate.</span>

<span class="sd">    xi : array_like</span>
<span class="sd">        Array of x coordinates where interpolation is required.</span>

<span class="sd">    yi : array_like</span>
<span class="sd">        Array of y coordinates where interpolation is required.</span>

<span class="sd">    extrapval : float | 0.</span>
<span class="sd">        Value for out of range positions.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">        f: array_like</span>
<span class="sd">            Extrapolated data.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">xi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">yi</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">nrows</span><span class="p">,</span> <span class="n">ncols</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">shape</span>

    <span class="k">if</span> <span class="n">nrows</span> <span class="o">&lt;</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">ncols</span> <span class="o">&lt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;z shape is too small&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span> <span class="o">==</span> <span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;sizes of X indexes and Y-indexes must match&quot;</span><span class="p">)</span>

    <span class="c1"># find x values out of range</span>
    <span class="n">x_bad</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">x_bad</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">x</span><span class="p">[</span><span class="n">x_bad</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># find y values out of range</span>
    <span class="n">y_bad</span> <span class="o">=</span> <span class="p">((</span><span class="n">y</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span><span class="n">y</span> <span class="o">&gt;</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">y_bad</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">y_bad</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># linear indexing. z must be in &#39;C&#39; order</span>
    <span class="n">ndx</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">ncols</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
    <span class="n">ndx</span> <span class="o">=</span> <span class="n">ndx</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>

    <span class="c1"># fix parameters on x border</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">==</span> <span class="n">ncols</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">x</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ndx</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-=</span> <span class="mi">1</span>

    <span class="c1"># fix parameters on y border</span>
    <span class="n">d</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">==</span> <span class="n">nrows</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">y</span> <span class="o">=</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">floor</span><span class="p">(</span><span class="n">y</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">d</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">y</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">ndx</span><span class="p">[</span><span class="n">d</span><span class="p">]</span> <span class="o">-=</span> <span class="n">ncols</span>

    <span class="c1"># interpolate</span>
    <span class="n">one_minus_t</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">y</span>
    <span class="n">z</span> <span class="o">=</span> <span class="n">z</span><span class="o">.</span><span class="n">ravel</span><span class="p">()</span>
    <span class="n">f</span> <span class="o">=</span> <span class="p">(</span><span class="n">z</span><span class="p">[</span><span class="n">ndx</span><span class="p">]</span> <span class="o">*</span> <span class="n">one_minus_t</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">ndx</span> <span class="o">+</span> <span class="n">ncols</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="p">(</span>
        <span class="n">z</span><span class="p">[</span><span class="n">ndx</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">one_minus_t</span> <span class="o">+</span> <span class="n">z</span><span class="p">[</span><span class="n">ndx</span> <span class="o">+</span> <span class="n">ncols</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span> <span class="o">*</span> <span class="n">x</span>

    <span class="c1"># Set out of range positions to extrapval</span>
    <span class="k">if</span> <span class="n">x_bad</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">f</span><span class="p">[</span><span class="n">x_bad</span><span class="p">]</span> <span class="o">=</span> <span class="n">extrapval</span>
    <span class="k">if</span> <span class="n">y_bad</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">f</span><span class="p">[</span><span class="n">y_bad</span><span class="p">]</span> <span class="o">=</span> <span class="n">extrapval</span>

    <span class="k">return</span> <span class="n">f</span></div>
</pre></div>

    </div>
      
  </div>
</div>
<footer class="footer">
  <div class="container">
    <p class="pull-right">
      <a href="#">Back to top</a>
      
    </p>
    <p>
        &copy; Copyright 2019, Etienne Combrisson.<br/>
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 2.1.2.<br/>
    </p>
  </div>
</footer>
  </body>
</html>