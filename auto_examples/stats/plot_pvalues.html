<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Compute and plot the p-values &#8212; Tensorpac 0.6.3 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tp_style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Compare PAC of two experimental conditions with cluster-based statistics" href="plot_compare_cond_cluster.html" />
    <link rel="prev" title="Identify stationary time-series using unit root test" href="plot_stats_stationary.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/ico64.png"></span>
          Tensorpac</a>
        <span class="navbar-text navbar-version pull-left"><b>0.6.3</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install.html">Install</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../index.html">Examples</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#standard-installation">Standard installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#install-the-most-up-to-date-version">Install the most up-to-date version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#compute-phase-amplitude-coupling">Compute phase-amplitude coupling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.Pac.html">tensorpac.Pac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.EventRelatedPac.html">tensorpac.EventRelatedPac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.PreferredPhase.html">tensorpac.PreferredPhase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#utility-functions">Utility functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.PSD.html">tensorpac.utils.PSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.ITC.html">tensorpac.utils.ITC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.BinAmplitude.html">tensorpac.utils.BinAmplitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.PeakLockedTF.html">tensorpac.utils.PeakLockedTF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.pac_vec.html">tensorpac.utils.pac_vec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.pac_trivec.html">tensorpac.utils.pac_trivec</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#generate-synthetic-signals">Generate synthetic signals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.signals.pac_signals_wavelet.html">tensorpac.signals.pac_signals_wavelet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.signals.pac_signals_tort.html">tensorpac.signals.pac_signals_tort</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.stats.test_stationarity.html">tensorpac.stats.test_stationarity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#individual-methods">Individual methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#pac-methods">PAC methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api.html#tensor-based-implementation">Tensor-based implementation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.mean_vector_length.html">tensorpac.methods.mean_vector_length</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.modulation_index.html">tensorpac.methods.modulation_index</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.heights_ratio.html">tensorpac.methods.heights_ratio</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.norm_direct_pac.html">tensorpac.methods.norm_direct_pac</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.phase_locking_value.html">tensorpac.methods.phase_locking_value</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.gauss_cop_pac.html">tensorpac.methods.gauss_cop_pac</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api.html#numba-based-implementation">Numba-based implementation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.mean_vector_length_nb.html">tensorpac.methods.mean_vector_length_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.modulation_index_nb.html">tensorpac.methods.modulation_index_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.heights_ratio_nb.html">tensorpac.methods.heights_ratio_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.norm_direct_pac_nb.html">tensorpac.methods.norm_direct_pac_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.phase_locking_value_nb.html">tensorpac.methods.phase_locking_value_nb</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#event-related-pac-methods">Event Related PAC methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.erpac.html">tensorpac.methods.erpac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.ergcpac.html">tensorpac.methods.ergcpac</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#preferred-phase">Preferred phase</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.preferred_phase.html">tensorpac.methods.preferred_phase</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#surrogates-methods">Surrogates methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.swap_pha_amp.html">tensorpac.methods.swap_pha_amp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.swap_blocks.html">tensorpac.methods.swap_blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.time_lag.html">tensorpac.methods.time_lag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#normalization">Normalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.normalize.html">tensorpac.methods.normalize</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../index.html#tutorials">Tutorials</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../tuto/plot_real_data.html">Phase-Amplitude Coupling tutorial on sEEG data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#download-the-data">Download the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#plot-the-raw-data">Plot the raw data</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#compute-and-plot-inter-trial-coherence">Compute and plot Inter Trial Coherence</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#compute-and-plot-the-power-spectrum-density">Compute and plot the Power Spectrum Density</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#compute-and-plot-the-event-related-pac">Compute and plot the Event-Related PAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#align-time-frequency-map-based-on-alpha-phase-peak">Align time-frequency map based on alpha phase peak</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#compute-and-compare-pac-that-is-occurring-during-rest-planning-and-execution">Compute and compare PAC that is occurring during rest, planning and execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#test-if-the-alpha-gamma-pac-is-significant-during-motor-planning">Test if the alpha-gamma PAC is significant during motor planning</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#binning-gamma-amplitude-according-to-alpha-phase">Binning gamma amplitude according to alpha phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../tuto/plot_real_data.html#identify-the-preferred-phase">Identify the preferred phase</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#phase-amplitude-coupling">Phase-Amplitude coupling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_readme.html">README example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_pac_methods.html">Comparison of the implemented PAC methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_pac_methods.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_pac_methods.html#extract-phases-and-amplitudes">Extract phases and amplitudes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_pac_methods.html#compute-plot-and-compare-pac">Compute, plot and compare PAC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_compare_surrogates.html">Compare methods to correct PAC for spurious coupling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_surrogates.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_surrogates.html#extract-phases-and-amplitudes">Extract phases and amplitudes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_surrogates.html#compute-pac-and-surrogates">Compute PAC and surrogates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_compare_normalizations.html">Compare normalization types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_normalizations.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_normalizations.html#extract-phases-and-amplitudes">Extract phases and amplitudes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_normalizations.html#recompute-pac-and-surrogates-and-switch-the-normalization-types">Recompute PAC and surrogates and switch the normalization types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_compare_filtering.html">Compare filtering properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_long_range_coupling.html">Long-range PAC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#event-related-phase-amplitude-coupling">Event-Related Phase-Amplitude coupling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../erpac/plot_erpac_stats.html">Event-Related Phase Amplitude Coupling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac_stats.html#generate-a-synthetic-signal">Generate a synthetic signal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac_stats.html#define-an-erpac-object-and-extract-the-phase-and-the-amplitude">Define an ERPAC object and extract the phase and the amplitude</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../erpac/plot_erpac.html">Event-Related Phase Amplitude Coupling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac.html#generate-a-synthetic-signal">Generate a synthetic signal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac.html#define-an-erpac-object-and-extract-the-phase-and-the-amplitude">Define an ERPAC object and extract the phase and the amplitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac.html#compute-the-erpac-using-the-two-implemented-methods-and-plot-it">Compute the ERPAC using the two implemented methods and plot it</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#statistics">Statistics</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="plot_compare_mcp.html">Comparison of methods for correcting p-values for multiple comparisons</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_compare_mcp.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_compare_mcp.html#compute-true-pac-estimation-and-surrogates-distribution">Compute true PAC estimation and surrogates distribution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_stats_stationary.html">Identify stationary time-series using unit root test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_stats_stationary.html#define-a-random-dataset">Define a random dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_stats_stationary.html#compute-the-statistical-test">Compute the statistical test</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_stats_stationary.html#plot-each-trial">Plot each trial</a></li>
</ul>
</li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">Compute and plot the p-values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compute-true-pac-estimation-and-surrogates-distribution">Compute true PAC estimation and surrogates distribution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="plot_compare_cond_cluster.html">Compare PAC of two experimental conditions with cluster-based statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="plot_compare_cond_cluster.html#simulate-the-data-coming-from-two-experimental-conditions">Simulate the data coming from two experimental conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_compare_cond_cluster.html#compute-the-single-trial-pac-on-both-datasets">Compute the single trial PAC on both datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_compare_cond_cluster.html#correct-for-multiple-comparisons-using-a-cluster-based-approach">Correct for multiple-comparisons using a cluster-based approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="plot_compare_cond_cluster.html#plot-the-significant-clusters">Plot the significant clusters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_psd.html">Compute and plot the Power Spectrum Density (PSD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_fmin_fmax_optmization.html">Find the optimal bandwidth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_binned_amplitude.html">Bin amplitude according to the phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html">Align time-frequency representations according to phase peak</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html#define-the-peak-locking-object-and-realign-tf-representations">Define the peak-locking object and realign TF representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html#plotting-the-realignment">Plotting the realignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_frequency_vectors.html">Define frequency vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_itc.html">Compute and plot the Inter-Trial Coherence (ITC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_itc.html#generate-a-random-data-of-shape-n-epochs-n-times">Generate a random data of shape (n_epochs, n_times)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_itc.html#compute-and-plot-the-power-spectrum-density-psd">Compute and plot the Power Spectrum Density (PSD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_itc.html#id1">Compute and plot the Inter-Trial Coherence (ITC)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_artificially_coupled_signals.html">Generate artificially coupled signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_preferred_phase.html">Find the preferred phase (PP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_preferred_phase.html#generate-synthetic-signals-sake-of-illustration">Generate synthetic signals (sake of illustration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_preferred_phase.html#extract-phases-amplitudes-and-compute-the-preferred-phase">Extract phases, amplitudes and compute the preferred phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_preferred_phase.html#plot-the-preferred-phase">Plot the preferred phase</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html#id1">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Cite Tensorpac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#report-an-issue">Report an issue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#chat">Chat</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/auto_examples/stats/plot_pvalues.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-stats-plot-pvalues-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="compute-and-plot-the-p-values">
<span id="sphx-glr-auto-examples-stats-plot-pvalues-py"></span><h1>Compute and plot the p-values<a class="headerlink" href="#compute-and-plot-the-p-values" title="Permalink to this headline">¶</a></h1>
<p>This example illustrates how to compute and plot the p-values. To this end,
Tensorpac uses permutations to estimate the distribution of PAC that could be
obtained by chance. Then, the true PAC estimation is compared with those
surrogates in order to get the p-values.</p>
<p>Note that the correction for multiple comparisons is automatically performed
across all phases and amplitudes. Tensorpac uses the maximum statistics to
perform this correction. Indeed, the permutations are computed for each
(phase, amplitude) pairs. The p-values are then inferred using the maximum
across all of the pairs.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">tensorpac</span> <span class="kn">import</span> <span class="n">Pac</span>
<span class="kn">from</span> <span class="nn">tensorpac.signals</span> <span class="kn">import</span> <span class="n">pac_signals_wavelet</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="section" id="simulate-artificial-coupling">
<h2>Simulate artificial coupling<a class="headerlink" href="#simulate-artificial-coupling" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>first, we generate a single trial that contains a coupling between a 6z phase
and a 90hz amplitude. By default, the returned dataset is organized as
(n_epochs, n_times) where n_times is the number of time points and n_epochs
is the number of trials</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">f_pha</span> <span class="o">=</span> <span class="mi">6</span>       <span class="c1"># frequency phase for the coupling</span>
<span class="n">f_amp</span> <span class="o">=</span> <span class="mi">90</span>      <span class="c1"># frequency amplitude for the coupling</span>
<span class="n">n_epochs</span> <span class="o">=</span> <span class="mi">1</span>    <span class="c1"># number of trials</span>
<span class="n">n_times</span> <span class="o">=</span> <span class="mi">4000</span>  <span class="c1"># number of time points</span>
<span class="n">sf</span> <span class="o">=</span> <span class="mf">512.</span>       <span class="c1"># sampling frequency</span>
<span class="n">data</span><span class="p">,</span> <span class="n">time</span> <span class="o">=</span> <span class="n">pac_signals_wavelet</span><span class="p">(</span><span class="n">f_pha</span><span class="o">=</span><span class="n">f_pha</span><span class="p">,</span> <span class="n">f_amp</span><span class="o">=</span><span class="n">f_amp</span><span class="p">,</span> <span class="n">noise</span><span class="o">=.</span><span class="mi">8</span><span class="p">,</span>
                                 <span class="n">n_epochs</span><span class="o">=</span><span class="n">n_epochs</span><span class="p">,</span> <span class="n">n_times</span><span class="o">=</span><span class="n">n_times</span><span class="p">,</span> <span class="n">sf</span><span class="o">=</span><span class="n">sf</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="compute-true-pac-estimation-and-surrogates-distribution">
<h2>Compute true PAC estimation and surrogates distribution<a class="headerlink" href="#compute-true-pac-estimation-and-surrogates-distribution" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Now, we compute the PAC using multiple phases and amplitudes such as the
distribution of surrogates. In this example, we used the method proposed by
Bahramisharif et al. 2013 <a class="bibtex reference internal" href="../../references.html#bahramisharif2013propagating" id="id1">[2]</a> and also
recommended by Aru et al. 2015 <a class="bibtex reference internal" href="../../references.html#aru2015untangling" id="id2">[1]</a>. This method
consists in swapping two time blocks of amplitudes cut at a random time
point. Then, we used the method <a class="reference internal" href="../../generated/tensorpac.Pac.html#tensorpac.Pac.infer_pvalues" title="tensorpac.Pac.infer_pvalues"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.Pac.infer_pvalues</span></code></a> in order
to get the corrected p-values across all possible (phase, amplitude)
frequency pairs.</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the Pac object</span>
<span class="n">p</span> <span class="o">=</span> <span class="n">Pac</span><span class="p">(</span><span class="n">idpac</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">f_pha</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">15</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">),</span> <span class="n">f_amp</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
<span class="c1"># compute true pac and surrogates</span>
<span class="n">n_perm</span> <span class="o">=</span> <span class="mi">200</span>  <span class="c1"># number of permutations</span>
<span class="n">xpac</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">filterfit</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">n_perm</span><span class="o">=</span><span class="n">n_perm</span><span class="p">,</span> <span class="n">n_jobs</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                   <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="c1"># get the corrected p-values</span>
<span class="n">pval</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">infer_pvalues</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="c1"># get the mean pac values where it&#39;s detected as significant</span>
<span class="n">xpac_smean</span> <span class="o">=</span> <span class="n">xpac</span><span class="p">[</span><span class="n">pval</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mi">05</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># if you want to see how the surrogates looks like, you can have to access</span>
<span class="c1"># using :class:`tensorpac.Pac.surrogates`</span>
<span class="n">surro</span> <span class="o">=</span> <span class="n">p</span><span class="o">.</span><span class="n">surrogates</span><span class="o">.</span><span class="n">squeeze</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Surrogates shape (n_perm, n_amp, n_pha) : </span><span class="si">{</span><span class="n">surro</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="c1"># get the maximum of the surrogates across (phase, amplitude) pairs</span>
<span class="n">surro_max</span> <span class="o">=</span> <span class="n">surro</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">comodulogram</span><span class="p">(</span><span class="n">xpac</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">p</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">pvalues</span><span class="o">=</span><span class="n">pval</span><span class="p">,</span>
               <span class="n">levels</span><span class="o">=.</span><span class="mi">05</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">p</span><span class="o">.</span><span class="n">comodulogram</span><span class="p">(</span><span class="n">pval</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;P-values&#39;</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;bwr_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">1.</span> <span class="o">/</span> <span class="n">n_perm</span><span class="p">,</span>
               <span class="n">vmax</span><span class="o">=.</span><span class="mi">05</span><span class="p">,</span> <span class="n">over</span><span class="o">=</span><span class="s1">&#39;lightgray&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">surro_max</span><span class="p">,</span> <span class="n">bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Corrected distribution of surrogates&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="n">xpac_smean</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">p</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_pvalues_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_pvalues_001.png" />
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Surrogates shape (n_perm, n_amp, n_pha) : (200, 55, 55)
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  6.224 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-stats-plot-pvalues-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/9c6c042faee357eac58abf6fb9bbae78/plot_pvalues.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_pvalues.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/375ab6a680067f5613d641d47af5c5ac/plot_pvalues.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_pvalues.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
    <hr>
    <footer>
        <div class="container">
            <img src="../../_static/baniere.png" alt="Ban" height="80">
        </div>
        <br>
        <div class="container">
            <ul class="list-inline">
                <li style="font-weight:bold"><a href="../../genindex.html">Index</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="https://github.com/EtienneCmb/tensorpac">Github</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../contributors.html">Contributors</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../community.html">Community</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../cite.html">Citation</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../references.html">References</a></li>
            </ul>
         </div>
        <!-- <br> -->
        <p>&copy; Copyright 2019, Etienne Combrisson.</p>
    </footer>

  </body>
</html>