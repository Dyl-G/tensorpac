<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta charset="utf-8" />
    <title>Phase-Amplitude Coupling tutorial on sEEG data &#8212; Tensorpac 0.6.4 documentation</title>
    <link rel="stylesheet" href="../../_static/bootstrap-sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/tp_style.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <link rel="shortcut icon" href="../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="README example" href="../pac/plot_readme.html" />
    <link rel="prev" title="Examples" href="../index.html" />
<meta charset='utf-8'>
<meta http-equiv='X-UA-Compatible' content='IE=edge,chrome=1'>
<meta name='viewport' content='width=device-width, initial-scale=1.0, maximum-scale=1'>
<meta name="apple-mobile-web-app-capable" content="yes">
<script type="text/javascript" src="../../_static/js/jquery-1.11.0.min.js "></script>
<script type="text/javascript" src="../../_static/js/jquery-fix.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-3.3.7/js/bootstrap.min.js "></script>
<script type="text/javascript" src="../../_static/bootstrap-sphinx.js "></script>

  </head><body>

  <div id="navbar" class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <!-- .btn-navbar is used as the toggle for collapsed navbar content -->
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".nav-collapse">
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="../../index.html"><span><img src="../../_static/ico64.png"></span>
          Tensorpac</a>
        <span class="navbar-text navbar-version pull-left"><b>0.6.4</b></span>
      </div>

        <div class="collapse navbar-collapse nav-collapse">
          <ul class="nav navbar-nav">
            
                <li><a href="../../install.html">Install</a></li>
                <li><a href="../../api.html">API</a></li>
                <li><a href="../index.html">Examples</a></li>
            
            
              <li class="dropdown globaltoc-container">
  <a role="button"
     id="dLabelGlobalToc"
     data-toggle="dropdown"
     data-target="#"
     href="../../index.html">Site <b class="caret"></b></a>
  <ul class="dropdown-menu globaltoc"
      role="menu"
      aria-labelledby="dLabelGlobalToc"><ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../install.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#requirements">Requirements</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#standard-installation">Standard installation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../install.html#install-the-most-up-to-date-version">Install the most up-to-date version</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#compute-phase-amplitude-coupling">Compute phase-amplitude coupling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.Pac.html">tensorpac.Pac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.EventRelatedPac.html">tensorpac.EventRelatedPac</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.PreferredPhase.html">tensorpac.PreferredPhase</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#utility-functions">Utility functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.PSD.html">tensorpac.utils.PSD</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.ITC.html">tensorpac.utils.ITC</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.BinAmplitude.html">tensorpac.utils.BinAmplitude</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.PeakLockedTF.html">tensorpac.utils.PeakLockedTF</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.pac_vec.html">tensorpac.utils.pac_vec</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.utils.pac_trivec.html">tensorpac.utils.pac_trivec</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#generate-synthetic-signals">Generate synthetic signals</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.signals.pac_signals_wavelet.html">tensorpac.signals.pac_signals_wavelet</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.signals.pac_signals_tort.html">tensorpac.signals.pac_signals_tort</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../generated/tensorpac.stats.test_stationarity.html">tensorpac.stats.test_stationarity</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../api.html#individual-methods">Individual methods</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#pac-methods">PAC methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../api.html#tensor-based-implementation">Tensor-based implementation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.mean_vector_length.html">tensorpac.methods.mean_vector_length</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.modulation_index.html">tensorpac.methods.modulation_index</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.heights_ratio.html">tensorpac.methods.heights_ratio</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.norm_direct_pac.html">tensorpac.methods.norm_direct_pac</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.phase_locking_value.html">tensorpac.methods.phase_locking_value</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.gauss_cop_pac.html">tensorpac.methods.gauss_cop_pac</a></li>
</ul>
</li>
<li class="toctree-l4"><a class="reference internal" href="../../api.html#numba-based-implementation">Numba-based implementation</a><ul>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.mean_vector_length_nb.html">tensorpac.methods.mean_vector_length_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.modulation_index_nb.html">tensorpac.methods.modulation_index_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.heights_ratio_nb.html">tensorpac.methods.heights_ratio_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.norm_direct_pac_nb.html">tensorpac.methods.norm_direct_pac_nb</a></li>
<li class="toctree-l5"><a class="reference internal" href="../../generated/tensorpac.methods.phase_locking_value_nb.html">tensorpac.methods.phase_locking_value_nb</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#event-related-pac-methods">Event Related PAC methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.erpac.html">tensorpac.methods.erpac</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.ergcpac.html">tensorpac.methods.ergcpac</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#preferred-phase">Preferred phase</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.preferred_phase.html">tensorpac.methods.preferred_phase</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#surrogates-methods">Surrogates methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.swap_pha_amp.html">tensorpac.methods.swap_pha_amp</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.swap_blocks.html">tensorpac.methods.swap_blocks</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.time_lag.html">tensorpac.methods.time_lag</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../api.html#normalization">Normalization</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../../generated/tensorpac.methods.normalize.html">tensorpac.methods.normalize</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1 current"><a class="reference internal" href="../index.html">Examples</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../index.html#tutorials">Tutorials</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Phase-Amplitude Coupling tutorial on sEEG data</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#download-the-data">Download the data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#plot-the-raw-data">Plot the raw data</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compute-and-plot-inter-trial-coherence">Compute and plot Inter Trial Coherence</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compute-and-plot-the-power-spectrum-density">Compute and plot the Power Spectrum Density</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compute-and-plot-the-event-related-pac">Compute and plot the Event-Related PAC</a></li>
<li class="toctree-l4"><a class="reference internal" href="#align-time-frequency-map-based-on-alpha-phase-peak">Align time-frequency map based on alpha phase peak</a></li>
<li class="toctree-l4"><a class="reference internal" href="#compute-and-compare-pac-that-is-occurring-during-rest-planning-and-execution">Compute and compare PAC that is occurring during rest, planning and execution</a></li>
<li class="toctree-l4"><a class="reference internal" href="#test-if-the-alpha-gamma-pac-is-significant-during-motor-planning">Test if the alpha-gamma PAC is significant during motor planning</a></li>
<li class="toctree-l4"><a class="reference internal" href="#binning-gamma-amplitude-according-to-alpha-phase">Binning gamma amplitude according to alpha phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="#identify-the-preferred-phase">Identify the preferred phase</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#phase-amplitude-coupling">Phase-Amplitude coupling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_readme.html">README example</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_pac_methods.html">Comparison of the implemented PAC methods</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_pac_methods.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_pac_methods.html#extract-phases-and-amplitudes">Extract phases and amplitudes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_pac_methods.html#compute-plot-and-compare-pac">Compute, plot and compare PAC</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_compare_surrogates.html">Compare methods to correct PAC for spurious coupling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_surrogates.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_surrogates.html#extract-phases-and-amplitudes">Extract phases and amplitudes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_surrogates.html#compute-pac-and-surrogates">Compute PAC and surrogates</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_compare_normalizations.html">Compare normalization types</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_normalizations.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_normalizations.html#extract-phases-and-amplitudes">Extract phases and amplitudes</a></li>
<li class="toctree-l4"><a class="reference internal" href="../pac/plot_compare_normalizations.html#recompute-pac-and-surrogates-and-switch-the-normalization-types">Recompute PAC and surrogates and switch the normalization types</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_compare_filtering.html">Compare filtering properties</a></li>
<li class="toctree-l3"><a class="reference internal" href="../pac/plot_long_range_coupling.html">Long-range PAC</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#event-related-phase-amplitude-coupling">Event-Related Phase-Amplitude coupling</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../erpac/plot_erpac_stats.html">Event-Related Phase Amplitude Coupling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac_stats.html#generate-a-synthetic-signal">Generate a synthetic signal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac_stats.html#define-an-erpac-object-and-extract-the-phase-and-the-amplitude">Define an ERPAC object and extract the phase and the amplitude</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../erpac/plot_erpac.html">Event-Related Phase Amplitude Coupling</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac.html#generate-a-synthetic-signal">Generate a synthetic signal</a></li>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac.html#define-an-erpac-object-and-extract-the-phase-and-the-amplitude">Define an ERPAC object and extract the phase and the amplitude</a></li>
<li class="toctree-l4"><a class="reference internal" href="../erpac/plot_erpac.html#compute-the-erpac-using-the-two-implemented-methods-and-plot-it">Compute the ERPAC using the two implemented methods and plot it</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#statistics">Statistics</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../stats/plot_compare_mcp.html">Comparison of methods for correcting p-values for multiple comparisons</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_compare_mcp.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_compare_mcp.html#compute-true-pac-estimation-and-surrogates-distribution">Compute true PAC estimation and surrogates distribution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/plot_stats_stationary.html">Identify stationary time-series using unit root test</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_stats_stationary.html#define-a-random-dataset">Define a random dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_stats_stationary.html#compute-the-statistical-test">Compute the statistical test</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_stats_stationary.html#plot-each-trial">Plot each trial</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/plot_pvalues.html">Compute and plot the p-values</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_pvalues.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_pvalues.html#compute-true-pac-estimation-and-surrogates-distribution">Compute true PAC estimation and surrogates distribution</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../stats/plot_compare_cond_cluster.html">Compare PAC of two experimental conditions with cluster-based statistics</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_compare_cond_cluster.html#simulate-the-data-coming-from-two-experimental-conditions">Simulate the data coming from two experimental conditions</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_compare_cond_cluster.html#compute-the-single-trial-pac-on-both-datasets">Compute the single trial PAC on both datasets</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_compare_cond_cluster.html#correct-for-multiple-comparisons-using-a-cluster-based-approach">Correct for multiple-comparisons using a cluster-based approach</a></li>
<li class="toctree-l4"><a class="reference internal" href="../stats/plot_compare_cond_cluster.html#plot-the-significant-clusters">Plot the significant clusters</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../index.html#miscellaneous">Miscellaneous</a><ul>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_psd.html">Compute and plot the Power Spectrum Density (PSD)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_fmin_fmax_optmization.html">Find the optimal bandwidth</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_binned_amplitude.html">Bin amplitude according to the phase</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html">Align time-frequency representations according to phase peak</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html#simulate-artificial-coupling">Simulate artificial coupling</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html#define-the-peak-locking-object-and-realign-tf-representations">Define the peak-locking object and realign TF representations</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_align_tf_pha_peak.html#plotting-the-realignment">Plotting the realignment</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_frequency_vectors.html">Define frequency vectors</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_itc.html">Compute and plot the Inter-Trial Coherence (ITC)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_itc.html#generate-a-random-data-of-shape-n-epochs-n-times">Generate a random data of shape (n_epochs, n_times)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_itc.html#compute-and-plot-the-power-spectrum-density-psd">Compute and plot the Power Spectrum Density (PSD)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_itc.html#id1">Compute and plot the Inter-Trial Coherence (ITC)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_artificially_coupled_signals.html">Generate artificially coupled signals</a></li>
<li class="toctree-l3"><a class="reference internal" href="../misc/plot_preferred_phase.html">Find the preferred phase (PP)</a><ul>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_preferred_phase.html#generate-synthetic-signals-sake-of-illustration">Generate synthetic signals (sake of illustration)</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_preferred_phase.html#extract-phases-amplitudes-and-compute-the-preferred-phase">Extract phases, amplitudes and compute the preferred phase</a></li>
<li class="toctree-l4"><a class="reference internal" href="../misc/plot_preferred_phase.html#plot-the-preferred-phase">Plot the preferred phase</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html">Authors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../contributors.html#id1">Contributors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../cite.html">Cite Tensorpac</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../community.html">Community</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#report-an-issue">Report an issue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../community.html#chat">Chat</a></li>
</ul>
</li>
</ul>
</ul>
</li>
              
            
            
            
            
            
              <li class="hidden-sm">
<div id="sourcelink">
  <a href="../../_sources/auto_examples/tuto/plot_real_data.rst.txt"
     rel="nofollow">Source</a>
</div></li>
            
          </ul>

          
            
<form class="navbar-form navbar-right" action="../../search.html" method="get">
 <div class="form-group">
  <input type="text" name="q" class="form-control" placeholder="Search" />
 </div>
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
          
        </div>
    </div>
  </div>

<div class="container">
  <div class="row">
    <div class="body col-md-12 content" role="main">
      
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-auto-examples-tuto-plot-real-data-py"><span class="std std-ref">here</span></a> to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="phase-amplitude-coupling-tutorial-on-seeg-data">
<span id="sphx-glr-auto-examples-tuto-plot-real-data-py"></span><h1>Phase-Amplitude Coupling tutorial on sEEG data<a class="headerlink" href="#phase-amplitude-coupling-tutorial-on-seeg-data" title="Permalink to this headline">¶</a></h1>
<p>In this example, we illustrate how to conduct a PAC analysis on real data. The
data used here are taken from Combrisson et al. 2017
<a class="bibtex reference internal" href="../../references.html#combrisson2017intentions" id="id1">[5]</a>. The task is a center-out motor task where the
subject have to reach a target on a screen with the mouse. A single trial
consists in three periods :</p>
<blockquote>
<div><ul class="simple">
<li><p>From [-1000, 0]ms it is the baseline period (REST)</p></li>
<li><p>From [0, 1500]ms the subject have to prepare the movement (MOTOR
PLANNING period)</p></li>
<li><p>From [1500, 3000]ms the subject perform the movement to reach the target
on the screen (MOTOR EXECUTION period)</p></li>
</ul>
</div></blockquote>
<p>The recorded electrophysiological data comes from an epileptic subject with
electrodes deep inside the brain (intracranial EEG or
stereoelectroencephalography). Here, the provided data contains only a single
recording contact for one subject. This contact is located in the premotor
cortex.</p>
<p>When working with phase-amplitude coupling, there are basically three questions
you should try to answer :</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>What is the range of phase frequencies supporting this coupling?</p></li>
<li><p>Where in time this coupling occurs?</p></li>
<li><p>What is the range of amplitude frequencies supporting this coupling?</p></li>
</ol>
</div></blockquote>
<p>In this tutorial we propose to answer to those three questions using following
structure :</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Compute the inter-trial coherence (ITC) and see if the phases are
realigned at a given time point (<a class="reference internal" href="../../generated/tensorpac.utils.ITC.html#tensorpac.utils.ITC" title="tensorpac.utils.ITC"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.utils.ITC</span></code></a>)</p></li>
<li><p>Compute the Power Spectrum Density (PSD) to try to find the phase
frequency range (<a class="reference internal" href="../../generated/tensorpac.utils.PSD.html#tensorpac.utils.PSD" title="tensorpac.utils.PSD"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.utils.PSD</span></code></a>)</p></li>
<li><p>Compute the Event-Related PAC (ERPAC) to have a first idea of where the
coupling occurs in time, especially if it start at a given time point
(<a class="reference internal" href="../../generated/tensorpac.EventRelatedPac.html#tensorpac.EventRelatedPac" title="tensorpac.EventRelatedPac"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.EventRelatedPac</span></code></a>)</p></li>
<li><p>Realign time-frequency representations based on the starting time-point
found with the ERPAC and see if the gamma burst follow the rhythm
imposed by a phase. This step should also gives and idea of the
amplitude frequency range (<a class="reference internal" href="../../generated/tensorpac.utils.PeakLockedTF.html#tensorpac.utils.PeakLockedTF" title="tensorpac.utils.PeakLockedTF"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.utils.PeakLockedTF</span></code></a>)</p></li>
<li><p>Compute the comodulogram and statistics in order to test if the
hypothetic coupling can be considered as statistically different from
PAC that could be obtained by chance (<a class="reference internal" href="../../generated/tensorpac.Pac.html#tensorpac.Pac" title="tensorpac.Pac"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.Pac</span></code></a>)</p></li>
<li><p>Preferred-phase identification (<a class="reference internal" href="../../generated/tensorpac.utils.BinAmplitude.html#tensorpac.utils.BinAmplitude" title="tensorpac.utils.BinAmplitude"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.utils.BinAmplitude</span></code></a>
and <a class="reference internal" href="../../generated/tensorpac.PreferredPhase.html#tensorpac.PreferredPhase" title="tensorpac.PreferredPhase"><code class="xref py py-class docutils literal notranslate"><span class="pre">tensorpac.PreferredPhase</span></code></a>)</p></li>
</ol>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">urllib</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">scipy.io</span> <span class="kn">import</span> <span class="n">loadmat</span>

<span class="kn">from</span> <span class="nn">tensorpac</span> <span class="kn">import</span> <span class="n">Pac</span><span class="p">,</span> <span class="n">EventRelatedPac</span><span class="p">,</span> <span class="n">PreferredPhase</span>
<span class="kn">from</span> <span class="nn">tensorpac.utils</span> <span class="kn">import</span> <span class="n">PeakLockedTF</span><span class="p">,</span> <span class="n">PSD</span><span class="p">,</span> <span class="n">ITC</span><span class="p">,</span> <span class="n">BinAmplitude</span>

<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
<div class="section" id="download-the-data">
<h2>Download the data<a class="headerlink" href="#download-the-data" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Lets first start by downloading the data. The file should be relatively
small to download (1.18M). The file is going to be saved in the same folder
where this script is launched. The data are downloaded only if the file is
not present in the current folder</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s1">&#39;seeg_data_pac.npz&#39;</span><span class="p">)</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Downloading the data&#39;</span><span class="p">)</span>
    <span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://www.dropbox.com/s/dn51xh7nyyttf33/seeg_data_pac.npz?dl=1&quot;</span>
    <span class="n">urllib</span><span class="o">.</span><span class="n">request</span><span class="o">.</span><span class="n">urlretrieve</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="n">filename</span><span class="o">=</span><span class="n">filename</span><span class="p">)</span>

<span class="n">arch</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span>       <span class="c1"># data of a single sEEG contact</span>
<span class="n">sf</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">arch</span><span class="p">[</span><span class="s1">&#39;sf&#39;</span><span class="p">])</span>    <span class="c1"># sampling frequency</span>
<span class="n">times</span> <span class="o">=</span> <span class="n">arch</span><span class="p">[</span><span class="s1">&#39;times&#39;</span><span class="p">]</span>     <span class="c1"># time vector</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;DATA: (n_trials, n_times)=</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">; SAMPLING FREQUENCY=</span><span class="si">{</span><span class="n">sf</span><span class="si">}</span><span class="s2">Hz; &quot;</span>
      <span class="sa">f</span><span class="s2">&quot;TIME VECTOR: n_times=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">times</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>Downloading the data
DATA: (n_trials, n_times)=(160, 4001); SAMPLING FREQUENCY=1024.0Hz; TIME VECTOR: n_times=4001
</pre></div>
</div>
</div>
<div class="section" id="plot-the-raw-data">
<h2>Plot the raw data<a class="headerlink" href="#plot-the-raw-data" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>In this section, we simply plot the mean of the raw data across the 160
trials</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># function for adding the sections rest / planning / execution to each figure</span>
<span class="k">def</span> <span class="nf">add_motor_condition</span><span class="p">(</span><span class="n">y_text</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;k&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">x_times</span> <span class="o">=</span> <span class="p">[</span><span class="o">-.</span><span class="mi">5</span><span class="p">,</span> <span class="mf">0.750</span><span class="p">,</span> <span class="mf">2.250</span><span class="p">]</span>
    <span class="n">x_conditions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;REST&#39;</span><span class="p">,</span> <span class="s1">&#39;MOTOR</span><span class="se">\n</span><span class="s1">PLANNING&#39;</span><span class="p">,</span> <span class="s1">&#39;MOTOR</span><span class="se">\n</span><span class="s1">EXECUTION&#39;</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">ax</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span>  <span class="c1"># noqa</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">sca</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">0.</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">x_t</span><span class="p">,</span> <span class="n">t_t</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">x_times</span><span class="p">,</span> <span class="n">x_conditions</span><span class="p">):</span>
        <span class="n">plt</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="n">x_t</span><span class="p">,</span> <span class="n">y_text</span><span class="p">,</span> <span class="n">t_t</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">color</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="n">ha</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span>
                 <span class="n">va</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">fontweight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">autoscale</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="n">tight</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Mean raw data across trials of a premotor sEEG site&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Times (in seconds)&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">600</span><span class="p">,</span> <span class="mi">800</span><span class="p">)</span>
<span class="n">add_motor_condition</span><span class="p">(</span><span class="mf">700.</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_001.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_001.png" />
</div>
<div class="section" id="compute-and-plot-inter-trial-coherence">
<h2>Compute and plot Inter Trial Coherence<a class="headerlink" href="#compute-and-plot-inter-trial-coherence" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The Inter Trial Coherence (ITC) returns a factor that indicates how much
the phases are consistent across trials. Here, we compute the ITC for
multiple phase frequencies</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">itc</span> <span class="o">=</span> <span class="n">ITC</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="n">f_pha</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">itc</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;plasma&#39;</span><span class="p">,</span> <span class="n">fz_labels</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">fz_title</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">add_motor_condition</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_002.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_002.png" />
<p>For this sEEG site, we can see that the very low frequency phase (~3Hz) are
realigned at the beginning of the execution period (~1500ms)</p>
</div>
<div class="section" id="compute-and-plot-the-power-spectrum-density">
<h2>Compute and plot the Power Spectrum Density<a class="headerlink" href="#compute-and-plot-the-power-spectrum-density" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Then, we compute the Power Spectrum Density (PSD) over all of the time-points
and plot the mean PSD over the 160 trials</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">psd</span> <span class="o">=</span> <span class="n">PSD</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sf</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="c1"># adding the mean PSD over trials</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">psd</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">confidence</span><span class="o">=</span><span class="mi">95</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="mi">5</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="c1"># adding the single trial PSD</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">psd</span><span class="o">.</span><span class="n">plot_st_psd</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Greys&#39;</span><span class="p">,</span> <span class="n">f_min</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">f_max</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=.</span><span class="mf">5e6</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="mf">0.</span><span class="p">,</span> <span class="n">log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                <span class="n">grid</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axvline</span><span class="p">(</span><span class="mi">12</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_003.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_003.png" />
<p>From the PSD above, we can see a clear peak around 10hz that could indicate
an alpha &lt;-&gt; gamma coupling. This peak is essentially comprised between
[8, 12]Hz. This range of frequencies is then gonig to be used to see if there
is indeed an alpha &lt;-&gt; gamma coupling (Aru et al. 2015
<a class="bibtex reference internal" href="../../references.html#aru2015untangling" id="id2">[1]</a>)</p>
</div>
<div class="section" id="compute-and-plot-the-event-related-pac">
<h2>Compute and plot the Event-Related PAC<a class="headerlink" href="#compute-and-plot-the-event-related-pac" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>To go one step further we can use the Event-Related PAC (ERPAC) in order to
isolate the gamma range that is coupled with the alpha phase such as when, in
time, this coupling occurs. Here, we compute the ERPAC using the
Gaussian-Copula mutual information (Ince et al. 2017
<a class="bibtex reference internal" href="../../references.html#ince2017statistical" id="id3">[6]</a>), between the alpha [8, 12]Hz and several gamma
amplitudes, at each time point.</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">rp_obj</span> <span class="o">=</span> <span class="n">EventRelatedPac</span><span class="p">(</span><span class="n">f_pha</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">f_amp</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">erpac</span> <span class="o">=</span> <span class="n">rp_obj</span><span class="o">.</span><span class="n">filterfit</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;gc&#39;</span><span class="p">,</span> <span class="n">smooth</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">rp_obj</span><span class="o">.</span><span class="n">pacplot</span><span class="p">(</span><span class="n">erpac</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(),</span> <span class="n">times</span><span class="p">,</span> <span class="n">rp_obj</span><span class="o">.</span><span class="n">yvec</span><span class="p">,</span> <span class="n">xlabel</span><span class="o">=</span><span class="s1">&#39;Time&#39;</span><span class="p">,</span>
               <span class="n">ylabel</span><span class="o">=</span><span class="s1">&#39;Amplitude frequency (Hz)&#39;</span><span class="p">,</span>
               <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Event-Related PAC occurring for alpha phase&#39;</span><span class="p">,</span>
               <span class="n">fz_labels</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">fz_title</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">add_motor_condition</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_004.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_004.png" />
<p>As you can see from the image above, there is an increase of alpha &lt;-&gt; gamma
(~90Hz) coupling that is occurring especially during the planning phase (i.e
between [0, 1500]ms)</p>
</div>
<div class="section" id="align-time-frequency-map-based-on-alpha-phase-peak">
<h2>Align time-frequency map based on alpha phase peak<a class="headerlink" href="#align-time-frequency-map-based-on-alpha-phase-peak" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>to confirm the previous result showing a potential alpha &lt;-&gt; gamma coupling
occuring during the planning phase, we can realign time-frequency
representations (TFR) based on the alpha peak at the beginning of the
planning phase (i.e at time code 0s)</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">peak</span> <span class="o">=</span> <span class="n">PeakLockedTF</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">sf</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="n">times</span><span class="o">=</span><span class="n">times</span><span class="p">,</span> <span class="n">f_pha</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span>
                    <span class="n">f_amp</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">160</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>
<span class="n">ax_1</span><span class="p">,</span> <span class="n">ax_2</span> <span class="o">=</span> <span class="n">peak</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">zscore</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">baseline</span><span class="o">=</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">750</span><span class="p">),</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span>
                       <span class="n">vmin</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">add_motor_condition</span><span class="p">(</span><span class="mi">135</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="n">ax_1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_005.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_005.png" />
<p>From the TFR bellow we can see the relative to baseline gamma increase such
as the beta desynchronization during the execution period, which is typical
for a motor site. Once realign on alpha phase, we can also see that gamma
burst are regularly spaced, following the alpha rhythm, especially the gamma
in [40, 120]Hz. this confirm that indeed, there is the presence of
alpha &lt;-&gt; gamma PAC occurring during the planning phase</p>
</div>
<div class="section" id="compute-and-compare-pac-that-is-occurring-during-rest-planning-and-execution">
<h2>Compute and compare PAC that is occurring during rest, planning and execution<a class="headerlink" href="#compute-and-compare-pac-that-is-occurring-during-rest-planning-and-execution" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>we now know that an alpha [8, 12]Hz &lt;-&gt; gamma (~90Hz) should occur
specifically during the planning phase. An other way to inspect this result
is to compute the PAC, across time-points, during the rest, motor planning
and motor execution periods. Bellow, we first extract several phases and
amplitudes, then we compute the Gaussian-Copula PAC inside the three motor
periods</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">p_obj</span> <span class="o">=</span> <span class="n">Pac</span><span class="p">(</span><span class="n">idpac</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="n">f_pha</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="o">.</span><span class="mi">2</span><span class="p">),</span> <span class="n">f_amp</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="c1"># extract all of the phases and amplitudes</span>
<span class="n">pha_p</span> <span class="o">=</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
<span class="n">amp_p</span> <span class="o">=</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;amplitude&#39;</span><span class="p">)</span>
<span class="c1"># define time indices where rest, planning and execution are defined</span>
<span class="n">time_rest</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">time_prep</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">2500</span><span class="p">)</span>
<span class="n">time_exec</span> <span class="o">=</span> <span class="nb">slice</span><span class="p">(</span><span class="mi">2500</span><span class="p">,</span> <span class="mi">4000</span><span class="p">)</span>
<span class="c1"># define phase / amplitude during rest / planning / execution</span>
<span class="n">pha_rest</span><span class="p">,</span> <span class="n">amp_rest</span> <span class="o">=</span> <span class="n">pha_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_rest</span><span class="p">],</span> <span class="n">amp_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_rest</span><span class="p">]</span>
<span class="n">pha_prep</span><span class="p">,</span> <span class="n">amp_prep</span> <span class="o">=</span> <span class="n">pha_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_prep</span><span class="p">],</span> <span class="n">amp_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_prep</span><span class="p">]</span>
<span class="n">pha_exec</span><span class="p">,</span> <span class="n">amp_exec</span> <span class="o">=</span> <span class="n">pha_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_exec</span><span class="p">],</span> <span class="n">amp_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_exec</span><span class="p">]</span>
<span class="c1"># compute PAC inside rest, planning, and execution</span>
<span class="n">pac_rest</span> <span class="o">=</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pha_rest</span><span class="p">,</span> <span class="n">amp_rest</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pac_prep</span> <span class="o">=</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pha_prep</span><span class="p">,</span> <span class="n">amp_prep</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">pac_exec</span> <span class="o">=</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pha_exec</span><span class="p">,</span> <span class="n">amp_exec</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>plot the comodulograms inside the rest, planning and execution period</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">vmax</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">([</span><span class="n">pac_rest</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pac_prep</span><span class="o">.</span><span class="n">max</span><span class="p">(),</span> <span class="n">pac_exec</span><span class="o">.</span><span class="n">max</span><span class="p">()])</span>
<span class="n">kw</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">vmax</span><span class="o">=</span><span class="n">vmax</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=.</span><span class="mi">04</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;viridis&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">14</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">131</span><span class="p">)</span>
<span class="n">p_obj</span><span class="o">.</span><span class="n">comodulogram</span><span class="p">(</span><span class="n">pac_rest</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;PAC Rest [-1, 0]s&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">132</span><span class="p">)</span>
<span class="n">p_obj</span><span class="o">.</span><span class="n">comodulogram</span><span class="p">(</span><span class="n">pac_prep</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;PAC Planning [0, 1.5]s&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">133</span><span class="p">)</span>
<span class="n">p_obj</span><span class="o">.</span><span class="n">comodulogram</span><span class="p">(</span><span class="n">pac_exec</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;PAC Execution [1.5, 3]s&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_006.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_006.png" />
<p>From the three comodulograms above, you can see that, during the planning
period there is an alpha [8, 12]Hz &lt;-&gt; gamma [80, 100]Hz that is not
present during the rest and execution periods</p>
</div>
<div class="section" id="test-if-the-alpha-gamma-pac-is-significant-during-motor-planning">
<h2>Test if the alpha-gamma PAC is significant during motor planning<a class="headerlink" href="#test-if-the-alpha-gamma-pac-is-significant-during-motor-planning" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>finally, here, we are going to test if the peak PAC that is occurring during
the planning period is significantly different for a surrogate distribution.
To this end, and as recommended by Aru et al. 2015, <a class="bibtex reference internal" href="../../references.html#aru2015untangling" id="id4">[1]</a>
the surrogate distribution is obtained by cutting an amplitude at a random
time-point and then swap the two blocks of amplitudes (Bahramisharif et al.
2013, <a class="bibtex reference internal" href="../../references.html#bahramisharif2013propagating" id="id5">[2]</a>). This procedure is then repeated
multiple times (e.g 200 or 1000 times) in order to obtained the distribution.
Finally, the p-value is inferred by computing the proportion exceeded by the
true coupling. In addition, the correction for multiple comparison is
obtained using the FDR.</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># still using the Gaussian-Copula PAC but this time, we also select the method</span>
<span class="c1"># for computing the permutations</span>
<span class="n">p_obj</span><span class="o">.</span><span class="n">idpac</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="c1"># compute pac and 200 surrogates</span>
<span class="n">pac_prep</span> <span class="o">=</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pha_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_prep</span><span class="p">],</span> <span class="n">amp_p</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_prep</span><span class="p">],</span> <span class="n">n_perm</span><span class="o">=</span><span class="mi">200</span><span class="p">,</span>
                     <span class="n">random_state</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="c1"># get the p-values</span>
<span class="n">mcp</span> <span class="o">=</span> <span class="s1">&#39;maxstat&#39;</span>
<span class="n">pvalues</span> <span class="o">=</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">infer_pvalues</span><span class="p">(</span><span class="n">p</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span> <span class="n">mcp</span><span class="o">=</span><span class="n">mcp</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># sphinx_gallery_thumbnail_number = 7</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span>
<span class="n">title</span> <span class="o">=</span> <span class="p">(</span><span class="sa">r</span><span class="s2">&quot;Significant alpha$\Leftrightarrow$gamma coupling occurring during &quot;</span>
         <span class="sa">f</span><span class="s2">&quot;the motor planning phase</span><span class="se">\n</span><span class="s2">(p&lt;0.05, </span><span class="si">{</span><span class="n">mcp</span><span class="si">}</span><span class="s2">-corrected for multiple &quot;</span>
          <span class="s2">&quot;comparisons)&quot;</span><span class="p">)</span>
<span class="c1"># plot the non-significant pac in gray</span>
<span class="n">pac_prep_ns</span> <span class="o">=</span> <span class="n">pac_prep</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pac_prep_ns</span><span class="p">[</span><span class="n">pvalues</span> <span class="o">&lt;</span> <span class="o">.</span><span class="mi">05</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">p_obj</span><span class="o">.</span><span class="n">comodulogram</span><span class="p">(</span><span class="n">pac_prep_ns</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">pac_prep_ns</span><span class="p">),</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">pac_prep_ns</span><span class="p">),</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="c1"># plot the significant pac in color</span>
<span class="n">pac_prep_s</span> <span class="o">=</span> <span class="n">pac_prep</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
<span class="n">pac_prep_s</span><span class="p">[</span><span class="n">pvalues</span> <span class="o">&gt;=</span> <span class="o">.</span><span class="mi">05</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>
<span class="n">p_obj</span><span class="o">.</span><span class="n">comodulogram</span><span class="p">(</span><span class="n">pac_prep_s</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">vmin</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmin</span><span class="p">(</span><span class="n">pac_prep_s</span><span class="p">),</span>
                   <span class="n">vmax</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">nanmax</span><span class="p">(</span><span class="n">pac_prep_s</span><span class="p">),</span> <span class="n">title</span><span class="o">=</span><span class="n">title</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">gca</span><span class="p">()</span><span class="o">.</span><span class="n">invert_yaxis</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_007.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_007.png" />
</div>
<div class="section" id="binning-gamma-amplitude-according-to-alpha-phase">
<h2>Binning gamma amplitude according to alpha phase<a class="headerlink" href="#binning-gamma-amplitude-according-to-alpha-phase" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>Another sanity check of whether the amplitude is indeed modulated by the
alpha phase is to bin this amplitude according to phase slices. If there’s no
modulation, the bin amplitude should looks like a uniform distribution (i.e
flat)</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># define phase and amplitude filtering properties</span>
<span class="n">kw_filt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">f_pha</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">],</span> <span class="n">f_amp</span><span class="o">=</span><span class="p">[</span><span class="mi">75</span><span class="p">,</span> <span class="mi">105</span><span class="p">],</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="c1"># bin the rest, planning and execution periods. Note that ideally, the entire</span>
<span class="c1"># trial should be filtered and then binning should be performed</span>
<span class="n">bin_rest</span> <span class="o">=</span> <span class="n">BinAmplitude</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">time_rest</span><span class="p">],</span> <span class="n">sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_filt</span><span class="p">)</span>
<span class="n">bin_prep</span> <span class="o">=</span> <span class="n">BinAmplitude</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">time_prep</span><span class="p">],</span> <span class="n">sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_filt</span><span class="p">)</span>
<span class="n">bin_exec</span> <span class="o">=</span> <span class="n">BinAmplitude</span><span class="p">(</span><span class="n">data</span><span class="p">[:,</span> <span class="n">time_exec</span><span class="p">],</span> <span class="n">sf</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_filt</span><span class="p">)</span>
</pre></div>
</div>
<p>now plot the binned amplitude inside the rest, planning and execution periods</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="c1"># bin rest period</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">bin_rest</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;REST&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="c1"># bin planning period</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">bin_prep</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MOTOR PLANNING&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="c1"># bin execution period</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">bin_exec</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">normalize</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;deg&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">),</span> <span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;MOTOR EXECUTION&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_008.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_008.png" />
<p>As you can see, the amplitude is modulated inside the resting and even more
inside the planning phase. On the other hand, during the execution, the
distribution stays flat. Note also that the amplitude is maximum arround
-150° (or 210°) during the planning phase</p>
</div>
<div class="section" id="identify-the-preferred-phase">
<h2>Identify the preferred phase<a class="headerlink" href="#identify-the-preferred-phase" title="Permalink to this headline">¶</a></h2>
<blockquote>
<div><p>The preferred phase is given by the phase bin at which the amplitude is
maximum. Said differently, the gamma amplitude is binned according to the
alpha phase. The preferred-phase is computed as the maximum of this
histogram. To identify this preferred-phase, we propose here a polar plotting
method to visualize retrieve the previous result using the histogram method</p>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># define the preferred phase object</span>
<span class="n">pp_obj</span> <span class="o">=</span> <span class="n">PreferredPhase</span><span class="p">(</span><span class="n">f_pha</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">12</span><span class="p">])</span>
<span class="c1"># only extract the alpha phase</span>
<span class="n">pp_pha</span> <span class="o">=</span> <span class="n">pp_obj</span><span class="o">.</span><span class="n">filter</span><span class="p">(</span><span class="n">sf</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">ftype</span><span class="o">=</span><span class="s1">&#39;phase&#39;</span><span class="p">)</span>
<span class="n">pp_pha_rest</span> <span class="o">=</span> <span class="n">pp_pha</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_rest</span><span class="p">]</span>
<span class="n">pp_pha_prep</span> <span class="o">=</span> <span class="n">pp_pha</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_prep</span><span class="p">]</span>
<span class="n">pp_pha_exec</span> <span class="o">=</span> <span class="n">pp_pha</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="n">time_exec</span><span class="p">]</span>
<span class="c1"># compute the preferred phase (reuse the amplitude computed above)</span>
<span class="n">ampbin_rest</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">vecbin</span> <span class="o">=</span> <span class="n">pp_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pp_pha_rest</span><span class="p">,</span> <span class="n">amp_rest</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<span class="n">ampbin_prep</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">vecbin</span> <span class="o">=</span> <span class="n">pp_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pp_pha_prep</span><span class="p">,</span> <span class="n">amp_prep</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<span class="n">ampbin_exec</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">vecbin</span> <span class="o">=</span> <span class="n">pp_obj</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">pp_pha_exec</span><span class="p">,</span> <span class="n">amp_exec</span><span class="p">,</span> <span class="n">n_bins</span><span class="o">=</span><span class="mi">72</span><span class="p">)</span>
<span class="c1"># mean binned amplitude across trials</span>
<span class="n">ampbin_rest</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ampbin_rest</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">ampbin_prep</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ampbin_prep</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="n">ampbin_exec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">ampbin_exec</span><span class="p">)</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
</pre></div>
</div>
<p>circular plot of the preferred-phase : the radius of each circle is the
chosen amplitude, the angle is the phase and the maximum of the disc values
(i.e the brightest color) gives the preferred-phase</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">18</span><span class="p">,</span> <span class="mf">5.2</span><span class="p">))</span>
<span class="n">kw_plt</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;Spectral_r&#39;</span><span class="p">,</span> <span class="n">interp</span><span class="o">=.</span><span class="mi">1</span><span class="p">,</span> <span class="n">cblabel</span><span class="o">=</span><span class="s1">&#39;Amplitude bins&#39;</span><span class="p">,</span>
              <span class="n">vmin</span><span class="o">=</span><span class="mf">0.012</span><span class="p">,</span> <span class="n">vmax</span><span class="o">=</span><span class="mf">0.016</span><span class="p">,</span> <span class="n">colorbar</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="mf">1.05</span><span class="p">,</span> <span class="n">fz_title</span><span class="o">=</span><span class="mi">18</span><span class="p">)</span>
<span class="n">pp_obj</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">ampbin_rest</span><span class="p">,</span> <span class="n">vecbin</span><span class="p">,</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">yvec</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="mi">131</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;REST&#39;</span><span class="p">,</span>
             <span class="o">**</span><span class="n">kw_plt</span><span class="p">)</span>
<span class="n">pp_obj</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">ampbin_prep</span><span class="p">,</span> <span class="n">vecbin</span><span class="p">,</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">yvec</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="mi">132</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MOTOR PLANNING&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_plt</span><span class="p">)</span>
<span class="n">pp_obj</span><span class="o">.</span><span class="n">polar</span><span class="p">(</span><span class="n">ampbin_exec</span><span class="p">,</span> <span class="n">vecbin</span><span class="p">,</span> <span class="n">p_obj</span><span class="o">.</span><span class="n">yvec</span><span class="p">,</span> <span class="n">subplot</span><span class="o">=</span><span class="mi">133</span><span class="p">,</span>
             <span class="n">title</span><span class="o">=</span><span class="s1">&#39;MOTOR EXECUTION&#39;</span><span class="p">,</span> <span class="o">**</span><span class="n">kw_plt</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<img alt="../../_images/sphx_glr_plot_real_data_009.png" class="sphx-glr-single-img" src="../../_images/sphx_glr_plot_real_data_009.png" />
<p>As you can see, we retrieve that the preferred bin alpha phase is around
-150° or 210° during the rest period but even more in the planning period.
While during the execution, it seems that the amplitude is not modulated by
the alpha phase</p>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 1 minutes  51.172 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-auto-examples-tuto-plot-real-data-py">
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/035413fda3d318e84c6045e52126d555/plot_real_data.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_real_data.py</span></code></a></p>
</div>
<div class="sphx-glr-download docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/c18546257dd2ef5d53834fe287a6598e/plot_real_data.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_real_data.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


    </div>
      
  </div>
</div>
    <hr>
    <footer>
        <div class="container">
            <img src="../../_static/baniere.png" alt="Ban" height="80">
        </div>
        <br>
        <div class="container">
            <ul class="list-inline">
                <li style="font-weight:bold"><a href="../../genindex.html">Index</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="https://github.com/EtienneCmb/tensorpac">Github</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../contributors.html">Contributors</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../community.html">Community</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../cite.html">Citation</a></li>
                <li>·</li>
                <li style="font-weight:bold"><a href="../../references.html">References</a></li>
            </ul>
         </div>
        <!-- <br> -->
        <p>&copy; Copyright 2019, Etienne Combrisson.</p>
    </footer>

  </body>
</html>